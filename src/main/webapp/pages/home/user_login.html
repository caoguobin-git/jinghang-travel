<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>
        欢迎登录</title>
    <script src="/bower_components/jquery/dist/jquery.js"></script>
</head>
<body>
<div id="user-login-box">
    <p class="user-login-box-msg">
        欢迎登录</p>
    用户名：<input
        class="username"
        placeholder="请输入用户名">
    <br/>
    密码：<input
        class="password"
        placeholder="请输入密码">
    <br/>
    <button class="cancle-user-login-btn">
        取消
    </button>
    <button class="confirm-user-login-btn">
        登录
    </button>
    <span class="to-register-page">还没有账号？点击登录</span>
</div>
</body>
</html>
<script>
    $(function () {
        $("#user-login-box .cancle-user-login-btn").click(gotoHomePage)
        $("#user-login-box .confirm-user-login-btn").click(doUserLogin)
        $("#user-login-box .to-register-page").click(toRegisterPage)
    })

    function doUserLogin() {
        console.log("hello")
        var username = $("#user-login-box .username").val()
        var password = $("#user-login-box .password").val()
        var url = "/user/login.do";
        if (username == null || username == "") {
            $("#user-register-box .user-register-box-msg").html("用户名不正确");
            return;
        }
        if (password == null || password == "") {
            $("user-register-box .user-register-box-msg").html("密码为空");
            return;
        }
        var param = {
            "username": username,
            "password": password
        }
        console.log(param)
        $.ajax({
            url:url,
            data:param,
            type:"post",
            dataType:"json",
            success:function (result) {
                console.log(result)
                if (result.status==200){
                    location.href="/index.do?t="+Math.random();
                }else {
                    $("#user-login-box .user-login-box-msg").html(result.data)
                }
            }
        })
    }

    function toRegisterPage() {
        location.href = "/user/loadPage.do?url=user_register&t=" + Math.random();
    }

    function gotoHomePage() {
        location.href = "/index.do?t=" + Math.random();
    }
</script>
